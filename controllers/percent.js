const Percent = require("../models/Percent");
const Ninio = require("../models/Ninio");

exports.createPercent = async (req, res) => {
  try {
    const {
      percentilCabeza,
      percentilAltura,
      percentilPeso,
      sexo,
      mes,
      paciente,
    } = req.body;

    let matriz;
    let matriz2;
    let matriz3;

    /***PERCENTIL ALTURA / LARGO ***/
    let resultadoLargo;

    var vLongitudHombre = [
      [
        1, 0, 0.511237696, 52.6959753, 0.048692684, 47.97812373, 48.55809206,
        49.45780383, 50.97918889, 52.6959753, 54.44054313, 56.03444099,
        56.99907737, 57.62984323,
      ],
      [
        1, 1, -0.45224446, 56.62842855, 0.04411683, 52.19859469, 52.72610659,
        53.55364657, 54.97910441, 56.62842855, 58.35059408, 59.96640329,
        60.96465379, 61.62591488,
      ],
      [
        1, 2, -0.990594599, 59.60895343, 0.041795583, 55.2632178, 55.7734505,
        56.57772145, 57.97439882, 59.60895343, 61.33788093, 62.981581,
        64.00788549, 64.69240909,
      ],
      [
        1, 3, -1.285837689, 62.07700027, 0.040454126, 57.73049293, 58.23744339,
        59.03830227, 60.43433439, 62.07700027, 63.82542604, 65.49858004,
        66.5488903, 67.25189597,
      ],
      [
        1, 4, -1.43031238, 64.2168641, 0.039633879, 59.82568616, 60.33646905,
        61.14409605, 62.55408849, 64.2168641, 65.99130663, 67.69404787,
        68.76537757, 69.48353966,
      ],
      [
        1, 5, -1.47657547, 66.1253149, 0.039123813, 61.66383709, 62.18260807,
        63.00295962, 64.43546338, 66.1253149, 67.92934759, 69.6612233,
        70.75128299, 71.48218225,
      ],
      [
        1, 6, -1.456837849, 67.8601799, 0.038811994, 63.31224239, 63.84166131,
        64.6785365, 66.13895735, 67.8601799, 69.6957947, 71.45609163,
        72.56306798, 73.30488349,
      ],
      [
        1, 7, -1.391898768, 69.45908458, 0.038633209, 64.8139542, 65.35583849,
        66.21181225, 67.70375, 69.45908458, 71.32735362, 73.11524683,
        74.23766746, 74.98899282,
      ],
      [
        1, 8, -1.29571459, 70.94803912, 0.038546833, 66.1983257, 66.75397985,
        67.63087749, 69.15681718, 70.94803912, 72.84947001, 74.66409757,
        75.80074408, 76.56047112,
      ],
      [
        1, 9, -1.177919048, 72.34586111, 0.038526262, 67.48634824, 68.05674555,
        68.95590629, 70.51760636, 72.34586111, 74.2806019, 76.1211038,
        77.2709525, 78.03819367,
      ],
      [
        1, 10, -1.045326049, 73.6666541, 0.038553387, 68.69360304, 69.27949219,
        70.20192461, 71.80064815, 73.6666541, 75.63461845, 77.50015825,
        78.66233936, 79.43637498,
      ],
      [
        1, 11, -0.902800887, 74.92129717, 0.038615501, 69.83200143, 70.43397431,
        71.38045547, 73.01711846, 74.92129717, 76.92224328, 78.81201697,
        79.98578218, 80.76602067,
      ],
      [
        1, 12, -0.753908107, 76.11837536, 0.038703461, 70.91087824, 71.52941204,
        72.50054958, 74.17581483, 76.11837536, 78.15195849, 80.06520155,
        81.24990316, 82.03585474,
      ],
      [
        1, 13, -0.601263523, 77.26479911, 0.038810557, 71.93769721, 72.57318381,
        73.56945922, 75.28380189, 77.26479911, 79.33060669, 81.26659566,
        82.46166865, 83.25292428,
      ],
      [
        1, 14, -0.446805039, 78.36622309, 0.038931784, 72.91853025, 73.57129631,
        74.59309471, 76.34684777, 78.36622309, 80.46379892, 82.42185154,
        83.62680003, 84.4230157,
      ],
      [
        1, 15, -0.291974772, 79.4273405, 0.039063356, 73.8583906, 74.5287119,
        75.57634333, 77.36973004, 79.4273405, 81.55620169, 83.53567593,
        84.75006241, 85.55094704,
      ],
      [
        1, 16, -0.13784767, 80.45209492, 0.039202382, 74.76147075, 75.44958259,
        76.52329754, 78.35645533, 80.45209492, 82.61174387, 84.61203638,
        85.83547302, 86.64077902,
      ],
      [
        1, 17, 0.014776155, 81.44383603, 0.039346629, 75.63131645, 76.3374214,
        77.43742235, 79.31042062, 81.44383603, 83.633769, 85.65431315,
        86.88645473, 87.69597052,
      ],
      [
        1, 18, 0.165304169, 82.40543643, 0.039494365, 76.47095628, 77.19523002,
        78.32168023, 80.23453383, 82.40543643, 84.62514968, 86.66541349,
        87.90595157, 88.71949558,
      ],
      [
        1, 19, 0.313301809, 83.33938063, 0.039644238, 77.28300001, 78.02559584,
        79.1786261, 81.13130578, 83.33938063, 85.58837479, 87.64785881,
        88.89651687, 89.71393273,
      ],
      [
        1, 20, 0.458455471, 84.24783394, 0.039795189, 78.06971429, 78.83076661,
        80.01048051, 82.00292107, 84.24783394, 86.5256172, 88.60385242,
        89.86038176, 90.68153436,
      ],
      [
        1, 21, 0.600544631, 85.13269658, 0.039946388, 78.83308172, 79.61270882,
        80.81918694, 82.85129371, 85.13269658, 87.43878685, 89.53533266,
        90.79950901, 91.62428129,
      ],
      [
        1, 22, 0.739438953, 85.9956488, 0.040097181, 79.57484556, 80.37315285,
        81.6064575, 83.67811296, 85.9956488, 88.32957471, 90.44401549,
        91.71563468, 92.54392389,
      ],
      [
        1, 23, 0.875000447, 86.8381751, 0.04024706, 80.29655659, 81.11363482,
        82.37380806, 84.48487091, 86.8381751, 89.19947894, 91.33142741,
        92.6103075, 93.44202663,
      ],
      [
        1, 24, 1.00720807, 87.66160934, 0.040395626, 80.9995873, 81.83551818,
        83.12258949, 85.27290404, 87.66160934, 90.04984549, 92.19893497,
        93.48490873, 94.31998042,
      ],
      [
        1, 25, 0.837251351, 88.45247282, 0.040577525, 81.74463953, 82.58135344,
        83.87244978, 86.03702902, 88.45247282, 90.87870056, 93.07143353,
        94.38774522, 95.24419299,
      ],
      [
        1, 26, 0.681492975, 89.22326434, 0.040723122, 82.47365273, 83.31105283,
        84.60576246, 86.78329346, 89.22326434, 91.68467603, 93.91817465,
        95.26300076, 96.13961611,
      ],
      [
        1, 27, 0.538779654, 89.97549228, 0.040833194, 83.18812206, 84.02609006,
        85.32398912, 87.513174, 89.97549228, 92.46928892, 94.74063663,
        96.1121012, 97.0076279,
      ],
      [
        1, 28, 0.407697153, 90.71040853, 0.040909059, 83.88930684, 84.72769162,
        86.02832996, 88.22787587, 90.71040853, 93.23384749, 95.54016226,
        96.93639476, 97.84957201,
      ],
      [
        1, 29, 0.286762453, 91.42907762, 0.040952433, 84.57826389, 85.41688027,
        86.71977994, 88.92840117, 91.42907762, 93.97950843, 96.31799565,
        97.73717289, 98.66676679,
      ],
      [
        1, 30, 0.174489485, 92.13242379, 0.04096533, 85.25588692, 86.09451745,
        87.39917477, 89.61559787, 92.13242379, 94.70731654, 97.0753111,
        98.51569104, 99.46052027,
      ],
      [
        1, 31, 0.069444521, 92.82127167, 0.040949976, 85.9229396, 86.76133892,
        88.06722988, 90.29020177, 92.82127167, 95.41823885, 97.8132366,
        99.27318378, 100.2321391,
      ],
      [
        1, 32, -0.029720564, 93.49637946, 0.040908737, 86.58008511, 87.41798587,
        88.72457345, 90.95287107, 93.49637946, 96.11319217, 98.53287254,
        100.0108765, 100.9829352,
      ],
      [
        1, 33, -0.124251789, 94.15846546, 0.040844062, 87.22791274, 88.06503203,
        89.37177427, 91.60421467, 94.15846546, 96.79306504, 99.23530653,
        100.7299947, 101.7142301,
      ],
      [
        1, 34, -0.215288396, 94.80822923, 0.040758431, 87.86696172, 88.70300745,
        90.00936536, 92.24481515, 94.80822923, 97.4587349, 99.92162482,
        101.4317705, 102.4273592,
      ],
      [
        1, 35, -0.30385434, 95.44636981, 0.040654312, 88.49774096, 89.33241837,
        90.63786404, 92.87524861, 95.44636981, 98.11108261, 100.5929212,
        102.1174472, 103.1236716,
      ],
    ];

    var vLongitudMujer = [
      [
        2, 0, -0.809249882, 51.68358057, 0.046818545, 47.46915792, 47.96323977,
        48.74248168, 50.09685513, 51.68358057, 53.36362339, 54.96222276,
        55.96094226, 56.62728063,
      ],
      [
        2, 1, -0.050782985, 55.28612813, 0.0434439, 50.95700562, 51.4799569,
        52.29626871, 53.69078138, 55.28612813, 56.93136077, 58.45612369,
        59.38910734, 60.00337771,
      ],
      [
        2, 2, 0.476851407, 58.09381906, 0.041716103, 53.62925292, 54.17907364,
        55.03144306, 56.47125217, 58.09381906, 59.74044694, 61.24305751,
        62.15165579, 62.74546997,
      ],
      [
        2, 3, 0.843299612, 60.45980763, 0.040705173, 55.85939936, 56.43334947,
        57.31892438, 58.80346208, 60.45980763, 62.12329513, 63.6264785,
        64.52875326, 65.115773,
      ],
      [
        2, 4, 1.097562257, 62.53669656, 0.040079765, 57.80470109, 58.40032437,
        59.31632768, 60.84386229, 62.53669656, 64.22507127, 65.74095895,
        66.64652556, 67.23397741,
      ],
      [
        2, 5, 1.272509641, 64.40632762, 0.039686845, 59.54799297, 60.16323075,
        61.10725836, 62.67589709, 64.40632762, 66.12417852, 67.65995218,
        68.57451607, 69.16667619,
      ],
      [
        2, 6, 1.390428859, 66.11841553, 0.039444555, 61.13893122, 61.77208015,
        62.74210283, 64.35005344, 66.11841553, 67.86849937, 69.42868425,
        70.35586907, 70.95545459,
      ],
      [
        2, 7, 1.466733925, 67.70574419, 0.039304738, 62.60993179, 63.25957954,
        64.2538878, 65.89952096, 67.70574419, 69.4897495, 71.07731063,
        72.01952455, 72.6283475,
      ],
      [
        2, 8, 1.512301976, 69.19123614, 0.03923711, 63.98348087, 64.64844828,
        65.6655939, 67.34744593, 69.19123614, 71.01018905, 72.62711495,
        73.58600806, 74.20531837,
      ],
      [
        2, 9, 1.534950767, 70.59163924, 0.039221665, 65.27590347, 65.95519757,
        66.99394371, 68.71070188, 70.59163924, 72.44613669, 74.09377512,
        75.07050088, 75.70118113,
      ],
      [
        2, 10, 1.540390875, 71.91961673, 0.039244672, 66.49947935, 67.19225646,
        68.25153766, 70.00202169, 71.91961673, 73.80996848, 75.4892313,
        76.48460495, 77.12728799,
      ],
      [
        2, 11, 1.532852892, 73.1850104, 0.03929642, 67.66371146, 68.36924855,
        69.44813905, 71.23128342, 73.1850104, 75.11132946, 76.82282345,
        77.83742285, 78.49256622,
      ],
      [
        2, 12, 1.51550947, 74.39564379, 0.039369875, 68.77612694, 69.49379917,
        70.5914881, 72.40632639, 74.39564379, 76.35790617, 78.10201973,
        79.13625191, 79.80418693,
      ],
      [
        2, 13, 1.490765028, 75.5578544, 0.039459832, 69.84280474, 70.57206791,
        71.6878396, 73.5334912, 75.5578544, 77.55593964, 79.33290204,
        80.3870486, 81.06801366,
      ],
      [
        2, 14, 1.460458255, 76.67685871, 0.039562382, 70.86873555, 71.60911222,
        72.74233055, 74.61798935, 76.67685871, 78.71057805, 80.52050098,
        81.59474986, 82.28891385,
      ],
      [
        2, 15, 1.426006009, 77.75700986, 0.039674542, 71.85807481, 72.60914323,
        73.75923909, 75.66416403, 77.75700986, 79.82612621, 81.66903345,
        82.76350174, 83.47098066,
      ],
      [
        2, 16, 1.388507095, 78.80198406, 0.03979401, 72.81432502, 73.57571021,
        74.74217142, 76.67567844, 78.80198406, 80.90622641, 82.78207554,
        83.89682611, 84.61769529,
      ],
      [
        2, 17, 1.348818127, 79.81491852, 0.039918994, 73.74047006, 74.51183666,
        75.69419965, 77.65565499, 79.81491852, 81.95399237, 83.86269087,
        84.99774469, 85.73204785,
      ],
      [
        2, 18, 1.307609654, 80.79851532, 0.040048084, 74.63907612, 75.42012252,
        76.61796557, 78.60677999, 80.79851532, 82.9721104, 84.91352766,
        86.06887316, 86.81662924,
      ],
      [
        2, 19, 1.265408149, 81.75512092, 0.040180162, 75.51236875, 76.30282224,
        77.51575989, 79.53138379, 81.75512092, 83.96291696, 85.93689348,
        87.11249363, 87.87370201,
      ],
      [
        2, 20, 1.222627732, 82.6867881, 0.04031434, 76.36229263, 77.16190547,
        78.3895838, 80.43150301, 82.6867881, 84.92845908, 86.93481346,
        88.13061128, 88.90525584,
      ],
      [
        2, 21, 1.179594365, 83.59532461, 0.040449904, 77.19055854, 77.9991046,
        79.24119737, 81.30892951, 83.59532461, 85.87054197, 87.9090764,
        89.12499925, 89.91305149,
      ],
      [
        2, 22, 1.136564448, 84.48233206, 0.040586283, 77.99868072, 78.81595272,
        80.07215803, 82.16524937, 84.48233206, 86.79076712, 88.8612716,
        90.09723454, 90.89865612,
      ],
      [
        2, 23, 1.093731947, 85.34923624, 0.040723015, 78.78800783, 79.61381456,
        80.88385147, 83.00187362, 85.34923624, 87.69056226, 89.79281852,
        91.04872752, 91.86347264,
      ],
      [
        2, 24, 1.051272912, 86.1973169, 0.040859727, 79.55974326, 80.39390918,
        81.67751732, 83.82006698, 86.1973169, 88.57120953, 90.70499153,
        91.98074369, 92.80875921,
      ],
      [
        2, 25, 1.041951175, 87.09026318, 0.041142161, 80.33998364, 81.18804253,
        82.49318413, 84.67208812, 87.09026318, 89.50562438, 91.67717995,
        92.97573731, 93.81864148,
      ],
      [
        2, 26, 1.012592236, 87.95714182, 0.041349399, 81.11331525, 81.97222927,
        83.29458969, 85.50360235, 87.95714182, 90.40981965, 92.61658225,
        93.93692673, 94.79426258,
      ],
      [
        2, 27, 0.970541909, 88.7960184, 0.041500428, 81.87334278, 82.74084468,
        84.07717332, 86.31150621, 88.7960184, 91.28258036, 93.52226565,
        94.86338935, 95.73464477,
      ],
      [
        2, 28, 0.921129988, 89.6055115, 0.041610508, 82.61506447, 83.48950736,
        84.83741222, 87.09345895, 89.6055115, 92.12313138, 94.39371454,
        95.75464088, 96.63927598,
      ],
      [
        2, 29, 0.868221392, 90.38476689, 0.041691761, 83.33473293, 84.2149589,
        85.57272806, 87.847827, 90.38476689, 92.93112624, 95.2308179,
        96.61061463, 97.50808067,
      ],
      [
        2, 30, 0.81454413, 91.13341722, 0.04175368, 84.02971817, 84.91494389,
        86.28139027, 88.57361882, 91.13341722, 93.7066212, 96.03384732,
        97.43163806, 98.34139389,
      ],
      [
        2, 31, 0.761957977, 91.8515436, 0.041803562, 84.69836716, 85.58808886,
        86.96242078, 89.2704229, 91.8515436, 94.45004782, 96.8034301,
        98.21840208, 99.13992666,
      ],
      [
        2, 32, 0.711660228, 92.5396352, 0.041846882, 85.3398692, 86.23378572,
        87.61550158, 89.9383459, 92.5396352, 95.16218257, 97.54051914,
        98.97192777, 99.90472932,
      ],
      [
        2, 33, 0.664323379, 93.19854429, 0.041887626, 85.95413399, 86.85208427,
        88.24088648, 90.57794935, 93.19854429, 95.84411175, 98.24636075,
        99.69353355, 100.6371574,
      ],
      [
        2, 34, 0.620285102, 93.82945392, 0.041928568, 86.5416688, 87.44358723,
        88.83931978, 91.19019802, 93.82945392, 96.49720519, 98.92246313,
        100.384796, 101.3388259,
      ],
      [
        2, 35, 0.57955631, 94.43382278, 0.041971514, 87.10348874, 88.00936554,
        89.41195884, 91.77639347, 94.43382278, 97.12307204, 99.57056254,
        101.0475227, 102.0115864,
      ],
    ];

    if (sexo === "hombre") {
      matriz = vLongitudHombre;
    } else {
      matriz = vLongitudMujer;
    }

    var arrayValores = matriz[mes];
    var aux_zscore = parseInt(percentilAltura) / arrayValores[3];

    var zScore = Math.log(aux_zscore) / arrayValores[4];
    var BASE = 1 + arrayValores[2] * arrayValores[4] * zScore;
    var EXPONENTE = 1 / arrayValores[2];
    var percentileScore = arrayValores[3] * BASE ** EXPONENTE;

    if (
      percentileScore >= arrayValores[5] &&
      percentileScore < arrayValores[6]
    ) {
      resultadoLargo = 3;
    }
    if (
      percentileScore >= arrayValores[6] &&
      percentileScore < arrayValores[7]
    ) {
      resultadoLargo = 5;
    }
    if (
      percentileScore >= arrayValores[7] &&
      percentileScore < arrayValores[8]
    ) {
      resultadoLargo = 10;
    }
    if (
      percentileScore >= arrayValores[8] &&
      percentileScore < arrayValores[9]
    ) {
      resultadoLargo = 25;
    }
    if (
      percentileScore >= arrayValores[9] &&
      percentileScore < arrayValores[10]
    ) {
      resultadoLargo = 50;
    }
    if (
      percentileScore >= arrayValores[10] &&
      percentileScore < arrayValores[11]
    ) {
      resultadoLargo = 75;
    }
    if (
      percentileScore >= arrayValores[11] &&
      percentileScore < arrayValores[12]
    ) {
      resultadoLargo = 90;
    }
    if (
      percentileScore >= arrayValores[12] &&
      percentileScore < arrayValores[13]
    ) {
      resultadoLargo = 95;
    }
    if (
      percentileScore >= arrayValores[13] &&
      percentileScore < arrayValores[14]
    ) {
      resultadoLargo = 97;
    }
    if (
      percentileScore < arrayValores[13] &&
      percentileScore > arrayValores[14]
    ) {
      resultadoLargo = 0;
    }
    /***************************************************/

    /***PERCENTIL CABEZA / CIRC ***/
    let resultadoCabeza;

    var vCircHombre = [
      [
        1, 0, 4.310927464, 37.19361054, 0.047259148, 33.25005839, 33.83391575,
        34.67252717, 35.93986771, 37.19361054, 38.3212548, 39.24988502,
        39.77261565, 40.10028445,
      ],
      [
        1, 1, 3.869576802, 39.20742929, 0.040947903, 35.78126227, 36.26427603,
        36.97376845, 38.07877607, 39.20742929, 40.2498675, 41.12605049,
        41.62581415, 41.94137873,
      ],
      [
        1, 2, 3.305593039, 40.65233195, 0.037027722, 37.55879748, 37.97958783,
        38.60724429, 39.60636994, 40.65233195, 41.63967944, 42.48435504,
        42.97189144, 43.28180775,
      ],
      [
        1, 3, 2.720590297, 41.76516959, 0.034364245, 38.89944028, 39.27893049,
        39.85122805, 40.77712846, 41.76516959, 42.71454952, 43.5390162,
        44.01984454, 44.3273323,
      ],
      [
        1, 4, 2.16804824, 42.66116148, 0.032462175, 39.956733, 40.30765556,
        40.8411358, 41.71483367, 42.66116148, 43.58358267, 44.39471535,
        44.87197284, 45.17876946,
      ],
      [
        1, 5, 1.675465689, 43.40488731, 0.031064702, 40.8164238, 41.14714268,
        41.65290563, 42.48888872, 43.40488731, 44.30801, 45.11034335,
        45.58592624, 45.89299742,
      ],
      [
        1, 6, 1.255160322, 44.03609923, 0.03002267, 41.53109397, 41.84741554,
        42.33330145, 43.14204136, 44.03609923, 44.92554888, 45.72225458,
        46.19735808, 46.50523827,
      ],
      [
        1, 7, 0.91054114, 44.58096912, 0.029242173, 42.13520784, 42.44134027,
        42.91311128, 43.70245428, 44.58096912, 45.46103549, 46.25442887,
        46.7298272, 47.03879825,
      ],
      [
        1, 8, 0.639510474, 45.05761215, 0.028660454, 42.65252672, 42.95162383,
        43.41364704, 44.18963565, 45.05761215, 45.93165855, 46.72349076,
        47.19970004, 47.50989695,
      ],
      [
        1, 9, 0.436978864, 45.4790756, 0.0282336, 43.1000854, 43.39457866,
        43.85025055, 44.61764431, 45.4790756, 46.34979269, 47.14142337,
        47.61879558, 47.93026746,
      ],
      [
        1, 10, 0.296275856, 45.85505706, 0.027929764, 43.49049033, 43.78229887,
        44.23431798, 44.99693519, 45.85505706, 46.72463077, 47.5171388,
        47.99592075, 48.30866909,
      ],
      [
        1, 11, 0.210107251, 46.19295427, 0.027725179, 43.83331672, 44.12398596,
        44.57453557, 45.33548679, 46.19295427, 47.06318161, 47.85743833,
        48.33780885, 48.65181107,
      ],
      [
        1, 12, 0.171147024, 46.49853438, 0.027601686, 44.1359978, 44.42679395,
        44.87766812, 45.6395204, 46.49853438, 47.37090639, 48.1676259,
        48.64971976, 48.96494367,
      ],
      [
        1, 13, 0.172393886, 46.77637684, 0.027545148, 44.40441201, 44.69638826,
        45.14908116, 45.91397652, 46.77637684, 47.65213989, 48.4519147,
        48.93583823, 49.25225076,
      ],
      [
        1, 14, 0.207371541, 47.03017599, 0.027544382, 44.6432831, 44.93732702,
        45.39309769, 46.16284044, 47.03017599, 47.9103782, 48.71370522,
        49.19954641, 49.51711865,
      ],
      [
        1, 15, 0.270226126, 47.2629533, 0.027590417, 44.85646007, 45.1533284,
        45.61324855, 46.38937093, 47.2629533, 48.14848042, 48.95578033,
        49.44361553, 49.76232529,
      ],
      [
        1, 16, 0.355757274, 47.47720989, 0.02767598, 45.0471177, 45.34746216,
        45.81245227, 46.5962646, 47.47720989, 48.36881356, 49.18044547,
        49.67034368, 49.99017661,
      ],
      [
        1, 17, 0.459407627, 47.67503833, 0.027795115, 45.21790307, 45.52229008,
        45.99314685, 46.78577645, 47.67503833, 48.57335854, 49.38963138,
        49.88165697, 50.20260675,
      ],
      [
        1, 18, 0.577227615, 47.85820606, 0.0279429, 45.37104465, 45.67997038,
        46.1573882, 46.95980996, 47.85820606, 48.76378933, 49.58497069,
        50.07918514, 50.40125302,
      ],
      [
        1, 19, 0.705826778, 48.02821867, 0.028115241, 45.50843477, 45.82233697,
        46.30692463, 47.1199854, 48.02821867, 48.94153284, 49.767856,
        50.26431891, 50.58751304,
      ],
      [
        1, 20, 0.842319055, 48.18636864, 0.028308707, 45.63169289, 45.95096016,
        46.4432543, 47.2676925, 48.18636864, 49.10781495, 49.93948448,
        50.43825419, 50.76258871,
      ],
      [
        1, 21, 0.984266833, 48.3337732, 0.028520407, 45.74221477, 46.06719402,
        46.56766983, 47.4041314, 48.3337732, 49.26369641, 50.10089268,
        50.60202648, 50.92752068,
      ],
      [
        1, 22, 1.129626698, 48.47140432, 0.028747896, 45.84121112, 46.17221358,
        46.68129357, 47.53034509, 48.47140432, 49.41010098, 50.25298383,
        50.75653813, 51.0832155,
      ],
      [
        1, 23, 1.276691223, 48.60011223, 0.028989089, 45.92973857, 46.26704456,
        46.78510558, 47.64724492, 48.60011223, 49.54783776, 50.39654965,
        50.90258011, 51.23046767,
      ],
      [
        1, 24, 1.424084853, 48.72064621, 0.029242207, 46.00872286, 46.35258644,
        46.87996641, 47.75563267, 48.72064621, 49.67762038, 50.53228805,
        51.04084871, 51.36997568,
      ],
      [
        1, 25, 1.570621291, 48.83366629, 0.029505723, 46.07898233, 46.42963351,
        46.96663488, 47.85621436, 48.83366629, 49.80007885, 50.6608169,
        51.17196156, 51.50235977,
      ],
      [
        1, 26, 1.715393998, 48.93976089, 0.029778323, 46.14123974, 46.49888834,
        47.0457837, 47.9496179, 48.93976089, 49.91577508, 50.78268619,
        51.29646691, 51.62816923,
      ],
      [
        1, 27, 1.857652984, 49.03945383, 0.030058871, 46.19613885, 46.56097639,
        47.11801133, 48.03640172, 49.03945383, 50.02521023, 50.89838727,
        51.41485491, 51.74789519,
      ],
      [
        1, 28, 1.996810563, 49.13321432, 0.030346384, 46.24425435, 46.61645615,
        47.18385241, 48.11706526, 49.13321432, 50.12883385, 51.00836092,
        51.52756491, 51.8619775,
      ],
      [
        1, 29, 2.132411346, 49.22146409, 0.030640006, 46.28610129, 46.66582817,
        47.24378625, 48.19205668, 49.22146409, 50.22705052, 51.11300399,
        51.63499226, 51.97081164,
      ],
      [
        1, 30, 2.264111009, 49.30458348, 0.030938992, 46.32214286, 46.70954267,
        47.29824404, 48.26177952, 49.30458348, 50.32022568, 51.212675,
        51.73749389, 52.0747544,
      ],
      [
        1, 31, 2.391658052, 49.38291658, 0.031242693, 46.35279696, 46.7480058,
        47.34761489, 48.32659828, 49.38291658, 50.4086904, 51.30769888,
        51.83539311, 52.17412868,
      ],
      [
        1, 32, 2.514878222, 49.45677569, 0.031550537, 46.37844176, 46.78158515,
        47.39225099, 48.38684322, 49.45677569, 50.49274559, 51.39837096,
        51.92898358, 52.26922758,
      ],
      [
        1, 33, 2.633661226, 49.526445, 0.031862026, 46.39942043, 46.81061427,
        47.43247203, 48.44281439, 49.526445, 50.57266545, 51.48496048,
        52.01853284, 52.36031789,
      ],
      [
        1, 34, 2.747949445, 49.59218385, 0.03217672, 46.41604524, 46.83539667,
        47.46856894, 48.49478513, 49.59218385, 50.64870057, 51.56771347,
        52.10428523, 52.44764311,
      ],
      [
        1, 35, 2.857728375, 49.65422952, 0.032494231, 46.42860105, 46.85620919,
        47.50080715, 48.54300509, 49.65422952, 50.72108047, 51.64685536,
        52.18646448, 52.53142603,
      ],
      [
        1, 36, 2.910932095, 49.68393611, 0.032653934, 46.43343534, 46.86520671,
        47.51555592, 48.56578071, 49.68393611, 50.75596627, 51.68513749,
        52.22627901, 52.57205364,
      ],
    ];

    var vCircMujer = [
      [
        2, 0, -1.440271514, 36.03453876, 0.042999604, 33.38070525, 33.68743507,
        34.17345861, 35.02508397, 36.03453876, 37.11806755, 38.16405088,
        38.82535049, 39.27005698,
      ],
      [
        2, 1, -1.581016348, 37.97671987, 0.038067862, 35.48627093, 35.77560367,
        36.23325692, 37.03281566, 37.97671987, 38.9853304, 39.95458524,
        40.56517149, 40.97482424,
      ],
      [
        2, 2, -1.593136386, 39.3801263, 0.035079612, 36.98550023, 37.26521982,
        37.70685493, 38.47603153, 39.3801263, 40.34145495, 41.2606303,
        41.83732218, 42.22321458,
      ],
      [
        2, 3, -1.521492427, 40.46773733, 0.033096443, 38.13114313, 38.40560987,
        38.83813686, 39.58904997, 40.46773733, 41.39732095, 42.28152907,
        42.83395649, 43.20260356,
      ],
      [
        2, 4, -1.394565915, 41.34841008, 0.03170963, 39.04619196, 39.31813786,
        39.74588078, 40.4861083, 41.34841008, 42.2560375, 43.11489105,
        43.64924082, 44.00485959,
      ],
      [
        2, 5, -1.231713389, 42.0833507, 0.030709039, 39.79959574, 40.07085921,
        40.49672423, 41.23135738, 42.0833507, 42.97566066, 43.81574641,
        44.33630066, 44.68183088,
      ],
      [
        2, 6, -1.046582628, 42.71033603, 0.029974303, 40.43379494, 40.70567458,
        41.13171253, 41.86434514, 42.71033603, 43.59207071, 44.41814599,
        44.92802856, 45.26562921,
      ],
      [
        2, 7, -0.848932692, 43.25428882, 0.029430992, 40.97671526, 41.25016088,
        41.67787092, 42.41113299, 43.25428882, 44.1289691, 44.94460711,
        45.44618705, 45.77750554,
      ],
      [
        2, 8, -0.645779124, 43.73249646, 0.029030379, 41.44767738, 41.72340175,
        42.15390873, 42.88977797, 43.73249646, 44.60281599, 45.41078317,
        45.90591158, 46.23224218,
      ],
      [
        2, 9, -0.442165412, 44.15742837, 0.028739112, 41.86058302, 42.1391311,
        42.57329563, 43.31329057, 44.15742837, 45.025498, 45.82798881,
        46.31814685, 46.64053024,
      ],
      [
        2, 10, -0.24163206, 44.53836794, 0.028533537, 42.22575305, 42.50754798,
        42.94603917, 43.69134604, 44.53836794, 45.40587424, 46.2046631,
        46.69105794, 47.01034581,
      ],
      [
        2, 11, -0.046673786, 44.88240562, 0.028396382, 42.55105219, 42.83642568,
        43.27976931, 44.03132658, 44.88240562, 45.75071845, 46.54726413,
        47.0308956, 47.34779597,
      ],
      [
        2, 12, 0.141031094, 45.19507651, 0.028314722, 42.84260355, 43.13181766,
        43.58043062, 44.33898883, 45.19507651, 46.06532374, 46.86084173,
        47.34254856, 47.65765724,
      ],
      [
        2, 13, 0.320403169, 45.48078147, 0.028278682, 43.10526272, 43.39852553,
        43.85274045, 44.61890505, 45.48078147, 46.3539026, 47.14941728,
        47.62991078, 47.9437344,
      ],
      [
        2, 14, 0.490807133, 45.74307527, 0.028280585, 43.34294145, 43.64041855,
        44.10050201, 44.87476468, 45.74307527, 46.61986076, 47.41624393,
        47.89613288, 48.20910612,
      ],
      [
        2, 15, 0.65193505, 45.98486901, 0.028314363, 43.55883459, 43.86065785,
        44.32682391, 45.10958609, 45.98486901, 46.86598965, 47.66398946,
        48.14379909, 48.45629769,
      ],
      [
        2, 16, 0.803718086, 46.20857558, 0.028375159, 43.75558315, 44.06185727,
        44.53427792, 45.32586864, 46.20857558, 47.09460485, 47.89486804,
        48.37505457, 48.68740549,
      ],
      [
        2, 17, 0.946259679, 46.41621635, 0.028459033, 43.93539362, 44.24620133,
        44.72501451, 45.52570414, 46.41621635, 47.30764771, 48.11073684,
        48.59169895, 48.90418837,
      ],
      [
        2, 18, 1.079784984, 46.60950084, 0.028562759, 44.10012707, 44.4155332,
        44.90084908, 45.71086007, 46.60950084, 47.50676129, 48.31316842,
        48.79525631, 49.10813597,
      ],
      [
        2, 19, 1.204602687, 46.78988722, 0.028683666, 44.25136665, 44.57142131,
        45.06332728, 45.88284266, 46.78988722, 47.69334806, 48.50350565,
        48.98702837, 49.30052069,
      ],
      [
        2, 20, 1.321076285, 46.95862881, 0.028819525, 44.39046947, 44.71521065,
        45.21377531, 46.04294544, 46.95862881, 47.86861428, 48.68290399,
        49.16813538, 49.48243771,
      ],
      [
        2, 21, 1.429602576, 47.11681039, 0.028968459, 44.51860703, 44.84806267,
        45.35333901, 46.19228703, 47.11681039, 48.03360465, 48.85236462,
        49.33954821, 49.65483625,
      ],
      [
        2, 22, 1.530595677, 47.26537682, 0.029128879, 44.63679702, 44.9709867,
        45.48301476, 46.33184096, 47.26537682, 48.18922971, 49.01276045,
        49.50211352, 49.81854421,
      ],
      [
        2, 23, 1.624475262, 47.40515585, 0.029299426, 44.74592866, 45.08486501,
        45.60367396, 46.46245944, 47.40515585, 48.3362876, 49.16485698,
        49.65657394, 49.97428788,
      ],
      [
        2, 24, 1.71165803, 47.53687649, 0.029478937, 44.8467831, 45.19047292,
        45.71608285, 46.58489242, 47.53687649, 48.47548169, 49.30932908,
        49.80358436, 50.12270782,
      ],
      [
        2, 25, 1.792551616, 47.66118396, 0.029666406, 44.94004992, 45.28849516,
        45.82091847, 46.69980317, 47.66118396, 48.60743482, 49.44677462,
        49.94372506, 50.26437172,
      ],
      [
        2, 26, 1.867550375, 47.77865186, 0.02986096, 45.02634065, 45.37953915,
        45.91878183, 46.80778091, 47.77865186, 48.73270105, 49.57772565,
        50.07751255, 50.39978499,
      ],
      [
        2, 27, 1.93703258, 47.8897923, 0.030061839, 45.10619989, 45.46414607,
        46.01020865, 46.90935129, 47.8897923, 48.85177527, 49.70265762,
        50.20540857, 50.52939951,
      ],
      [
        2, 28, 2.001358669, 47.99506422, 0.030268375, 45.18011452, 45.54279995,
        46.09567835, 47.00498513, 47.99506422, 48.96510128, 49.82199704,
        50.32782741, 50.65362082,
      ],
      [
        2, 29, 2.060870301, 48.09488048, 0.030479985, 45.24852146, 45.61593528,
        46.17562155, 47.0951056, 48.09488048, 49.07307846, 49.93612795,
        50.44514221, 50.77281425,
      ],
      [
        2, 30, 2.115889982, 48.18961365, 0.03069615, 45.31181411, 45.68394345,
        46.25042633, 47.18009439, 48.18961365, 49.17606748, 50.04539729,
        50.55769018, 50.88731003,
      ],
      [
        2, 31, 2.16672113, 48.2796011, 0.030916413, 45.37034782, 45.74717813,
        46.32044357, 47.26029687, 48.2796011, 49.27439505, 50.15011948,
        50.66577699, 50.99740757,
      ],
      [
        2, 32, 2.21364844, 48.36514917, 0.031140368, 45.42444455, 45.80595987,
        46.38599146, 47.33602646, 48.36514917, 49.36835799, 50.25058031,
        50.7696806, 51.10337919,
      ],
      [
        2, 33, 2.256943216, 48.44653703, 0.031367651, 45.47439662, 45.86057993,
        46.44735943, 47.40756856, 48.44653703, 49.45822692, 50.34704031,
        50.86965434, 51.20547307,
      ],
      [
        2, 34, 2.296844024, 48.52401894, 0.031597939, 45.52047097, 45.91130407,
        46.50481123, 47.47518307, 48.52401894, 49.54424855, 50.43973755,
        50.96593013, 51.30391674,
      ],
      [
        2, 35, 2.333589434, 48.59782828, 0.031830942, 45.56291074, 45.95837475,
        46.55858812, 47.53910827, 48.59782828, 49.62664932, 50.52889019,
        51.05872021, 51.39891816,
      ],
      [
        2, 36, 2.350847202, 48.63342328, 0.031948378, 45.58283802, 45.98061022,
        46.58416826, 47.56975632, 48.63342328, 49.66655746, 50.57220052,
        51.1038697, 51.44518843,
      ],
    ];

    if (sexo === "hombre") {
      matriz2 = vCircHombre;
    } else {
      matriz2 = vCircMujer;
    }

    var arrayValores2 = matriz2[mes];
    var aux_zscore2 = parseInt(percentilCabeza) / arrayValores2[3];

    var zScore2 = Math.log(aux_zscore2) / arrayValores2[4];
    var BASE2 = 1 + arrayValores2[2] * arrayValores2[4] * zScore2;
    var EXPONENTE2 = 1 / arrayValores2[2];
    var percentileScore2 = arrayValores2[3] * BASE2 ** EXPONENTE2;

    if (
      percentileScore2 >= arrayValores2[5] &&
      percentileScore2 < arrayValores2[6]
    ) {
      resultadoCabeza = 3;
    }
    if (
      percentileScore2 >= arrayValores2[6] &&
      percentileScore2 < arrayValores2[7]
    ) {
      resultadoCabeza = 5;
    }
    if (
      percentileScore2 >= arrayValores2[7] &&
      percentileScore2 < arrayValores2[8]
    ) {
      resultadoCabeza = 10;
    }
    if (
      percentileScore2 >= arrayValores2[8] &&
      percentileScore2 < arrayValores2[9]
    ) {
      resultadoCabeza = 25;
    }
    if (
      percentileScore2 >= arrayValores2[9] &&
      percentileScore2 < arrayValores2[10]
    ) {
      resultadoCabeza = 50;
    }
    if (
      percentileScore2 >= arrayValores2[10] &&
      percentileScore2 < arrayValores2[11]
    ) {
      resultadoCabeza = 75;
    }
    if (
      percentileScore2 >= arrayValores2[11] &&
      percentileScore2 < arrayValores2[12]
    ) {
      resultadoCabeza = 90;
    }
    if (
      percentileScore2 >= arrayValores2[12] &&
      percentileScore2 < arrayValores2[13]
    ) {
      resultadoCabeza = 95;
    }
    if (
      percentileScore2 >= arrayValores2[13] &&
      percentileScore2 < arrayValores2[14]
    ) {
      resultadoCabeza = 97;
    }
    if (
      percentileScore2 < arrayValores2[13] &&
      percentileScore2 > arrayValores2[14]
    ) {
      resultadoCabeza = 0;
    }
    /***************************************************/

    /***PERCENTIL PESO / MASA ***/
    let resultadoPeso;

    var vPesosHombre = [
      [
        1, 1, 1.068795548, 4.879525083, 0.136478767, 3.614688072, 3.774848862,
        4.020561446, 4.428872952, 4.879525083, 5.327327567, 5.728152752,
        5.967101615, 6.121929103,
      ],
      [
        1, 2, 0.695973505, 5.672888765, 0.129677511, 4.34234145, 4.503255345,
        4.754479354, 5.183377547, 5.672888765, 6.175598158, 6.638979132,
        6.921119162, 7.106250132,
      ],
      [
        1, 3, 0.41981509, 6.391391982, 0.124717085, 4.992897896, 5.157411653,
        5.416802856, 5.866806254, 6.391391982, 6.942217106, 7.460702368,
        7.781401145, 7.993878049,
      ],
      [
        1, 4, 0.219866801, 7.041836432, 0.121040119, 5.575169066, 5.744751566,
        6.01371624, 6.484969167, 7.041836432, 7.635323002, 8.202193202,
        8.556813353, 8.793443663,
      ],
      [
        1, 5, 0.077505598, 7.630425182, 0.1182712, 6.096775274, 6.272175299,
        6.551379244, 7.043626918, 7.630425182, 8.262032991, 8.871384112,
        9.255614546, 9.51330656,
      ],
      [
        1, 6, -0.02190761, 8.162951035, 0.116153695, 6.564430346, 6.745992665,
        7.035656404, 7.548345716, 8.162951035, 8.828786159, 9.47546616,
        9.885435743, 10.16135019,
      ],
      [
        1, 7, -0.0894409, 8.644832479, 0.114510349, 6.984123338, 7.171952393,
        7.472021438, 8.004398775, 8.644832479, 9.34149038, 10.02101374,
        10.45331433, 10.74492376,
      ],
      [
        1, 8, -0.1334091, 9.081119817, 0.113217163, 7.361236116, 7.555286752,
        7.865532922, 8.416718775, 9.081119817, 9.805593364, 10.51406421,
        10.96573632, 11.27083843,
      ],
      [
        1, 9, -0.1600954, 9.476500305, 0.11218624, 7.700624405, 7.90075516,
        8.220839211, 8.789881892, 9.476500305, 10.22612395, 10.96017225,
        11.42867623, 11.74538465,
      ],
      [
        1, 10, -0.17429685, 9.835307701, 0.111354536, 8.006677447, 8.212683538,
        8.542195484, 9.128109523, 9.835307701, 10.60772151, 11.36445045,
        11.84763282, 12.17435729,
      ],
      [
        1, 11, -0.1797189, 10.16153567, 0.110676413, 8.283364855, 8.494999555,
        8.833485623, 9.43527941, 10.16153567, 10.9546603, 11.73160184,
        12.2276612, 12.56308347,
      ],
      [
        1, 12, -0.179254, 10.45885399, 0.110118635, 8.534275028, 8.751264252,
        9.098245709, 9.714941801, 10.45885399, 11.27087147, 12.06594792,
        12.57340193, 12.91645043,
      ],
      [
        1, 13, -0.17518447, 10.7306256, 0.109656941, 8.762648582, 8.984701111,
        9.339687673, 9.970337596, 10.7306256, 11.55996332, 12.37145331,
        12.88910809, 13.23893338,
      ],
      [
        1, 14, -0.16932268, 10.97992482, 0.109273653, 8.971407287, 9.198222429,
        9.560722369, 10.20441778, 10.97992482, 11.82524099, 12.65174864,
        13.17867019, 13.53462171,
      ],
      [
        1, 15, -0.1631139, 11.20955529, 0.10895596, 9.163180317, 9.394453831,
        9.763981751, 10.41986276, 11.20955529, 12.06972515, 12.91015164,
        13.44563963, 13.80724431,
      ],
      [
        1, 16, -0.15770999, 11.4220677, 0.108694678, 9.340328068, 9.575756968,
        9.951839998, 10.61910138, 11.4220677, 12.29616991, 13.14968707,
        13.6932508, 14.0601935,
      ],
      [
        1, 17, -0.15402279, 11.61977698, 0.108483324, 9.504964014, 9.744250626,
        10.12643352, 10.80432929, 11.61977698, 12.50708008, 13.37310558,
        13.92444193, 14.29654774,
      ],
      [
        1, 18, -0.15276214, 11.80477902, 0.108317416, 9.658974787, 9.901830339,
        10.28967982, 10.97752662, 11.80477902, 12.70472779, 13.58290165,
        14.14187481, 14.51909298,
      ],
      [
        1, 19, -0.15446658, 11.9789663, 0.108193944, 9.804039109, 10.05018686,
        10.44329524, 11.14047457, 11.9789663, 12.89116805, 13.78133058,
        14.34795358, 14.73034312,
      ],
      [
        1, 20, -0.15952202, 12.14404334, 0.108110954, 9.941644878, 10.19082308,
        10.58881155, 11.2947714, 12.14404334, 13.06825426, 13.9704249,
        14.54484233, 14.93255878,
      ],
      [
        1, 21, -0.16817926, 12.30154103, 0.108067236, 10.07310549, 10.32507004,
        10.72759156, 11.44184727, 12.30154103, 13.23765258, 14.15200982,
        14.73448194, 15.12776542,
      ],
      [
        1, 22, -0.1805668, 12.45283028, 0.108062078, 10.19957488, 10.45410181,
        10.86084353, 11.58297823, 12.45283028, 13.40085582, 14.3277181,
        14.91860604, 15.31777023,
      ],
      [
        1, 23, -0.19670196, 12.59913494, 0.108095077, 10.32206165, 10.57894925,
        10.98963476, 11.7192993, 12.59913494, 13.55919667, 14.49900418,
        15.09875606, 15.50417803,
      ],
      [
        1, 24, -0.21650121, 12.74154396, 0.108166005, 10.4414422, 10.70051298,
        11.11490406, 11.85181666, 12.74154396, 13.71386029, 14.6671577,
        15.27629562, 15.68840631,
      ],
      [
        1, 25, -0.23979048, 12.88102276, 0.108274705, 10.55847309, 10.81957536,
        11.23747341, 11.98141892, 12.88102276, 13.86589625, 14.83331632,
        15.45242405, 15.87169941,
      ],
      [
        1, 26, -0.26631585, 13.01842382, 0.108421024, 10.67380261, 10.93681171,
        11.35805876, 12.10888759, 13.01842382, 14.0162298, 14.99847794,
        15.62818936, 16.05514188,
      ],
      [
        1, 27, -0.29575496, 13.1544966, 0.108604769, 10.78798156, 11.05280067,
        11.47727994, 12.23490671, 13.1544966, 14.1656725, 15.16351231,
        15.80450043, 16.23967114,
      ],
      [
        1, 28, -0.32772936, 13.28989667, 0.108825681, 10.90147346, 11.168034,
        11.59566994, 12.36007175, 13.28989667, 14.31493214, 15.32917196,
        15.98213866, 16.42608957,
      ],
      [
        1, 29, -0.36181746, 13.42519408, 0.109083423, 11.01466395, 11.28292555,
        11.7136834, 12.48489772, 13.42519408, 14.46462206, 15.49610261,
        16.16176896, 16.61507584,
      ],
      [
        1, 30, -0.39756808, 13.56088113, 0.109377581, 11.12786972, 11.3978197,
        11.8317045, 12.60982671, 13.56088113, 14.61526973, 15.66485286,
        16.34395024, 16.80719582,
      ],
      [
        1, 31, -0.43452025, 13.69737858, 0.109707646, 11.24134752, 11.51299966,
        11.95005435, 12.73523417, 13.69737858, 14.76732387, 15.83588308,
        16.52914562, 17.00291386,
      ],
      [
        1, 32, -0.47218875, 13.83504622, 0.110073084, 11.3552982, 11.62869248,
        12.06899744, 12.86143776, 13.83504622, 14.9211657, 16.00957526,
        16.71773017, 17.2025984,
      ],
      [
        1, 33, -0.51012309, 13.97418199, 0.110473238, 11.46987977, 11.74507947,
        12.18874835, 12.98869905, 13.97418199, 15.07710916, 16.18623873,
        16.91000241, 17.40653835,
      ],
      [
        1, 34, -0.54788557, 14.1150324, 0.1109074, 11.58520959, 11.86229971,
        12.30947723, 13.11723187, 14.1150324, 15.23541179, 16.36611917,
        17.10619066, 17.61494698,
      ],
      [
        1, 35, -0.5850701, 14.25779618, 0.111374787, 11.70137143, 11.98045644,
        12.43131521, 13.24720657, 14.25779618, 15.3962791, 16.54940494,
        17.30646132, 17.8279717,
      ],
      [
        1, 36, -0.60333785, 14.32994444, 0.111620652, 11.75978387, 12.03991048,
        12.49268178, 13.31277633, 14.32994444, 15.47772447, 16.6423691,
        17.40816491, 17.93624653,
      ],
    ];

    var vPesosMujer = [
      [
        2, 0, 1.357944315, 3.79752846, 0.138075916, 2.756916984, 2.894442278,
        3.101767067, 3.437628263, 3.79752846, 4.145593668, 4.450125603,
        4.628836382, 4.743581789,
      ],
      [
        2, 1, 1.105537708, 4.544776513, 0.131733888, 3.402293298, 3.547610305,
        3.770157472, 4.13899376, 4.544776513, 4.946765504, 5.305632496,
        5.51916925, 5.657379108,
      ],
      [
        2, 2, 0.902596648, 5.230584214, 0.126892697, 3.997805608, 4.150638506,
        4.387041982, 4.784820426, 5.230584214, 5.680083196, 6.08764077,
        6.332837055, 6.492574414,
      ],
      [
        2, 3, 0.734121414, 5.859960798, 0.123025182, 4.54738333, 4.70712251,
        4.95592631, 5.379141034, 5.859960798, 6.351511983, 6.802769825,
        7.076722522, 7.256165568,
      ],
      [
        2, 4, 0.590235275, 6.437587751, 0.119840911, 5.054538727, 5.220487543,
        5.480295205, 5.92588831, 6.437587751, 6.966523789, 7.45711879,
        7.757233948, 7.954730061,
      ],
      [
        2, 5, 0.464391566, 6.967850457, 0.117166868, 5.522500226, 5.693974176,
        5.963510428, 6.428828208, 6.967850457, 7.53018045, 8.056331004,
        8.380329759, 8.59441348,
      ],
      [
        2, 6, 0.352164071, 7.454854109, 0.11489384, 5.954272494, 6.130641295,
        6.408775097, 6.891533095, 7.454854109, 8.047178246, 8.605635546,
        8.951543685, 9.180938407,
      ],
      [
        2, 7, 0.250497889, 7.902436186, 0.112949644, 6.352668277, 6.533372908,
        6.819122283, 7.317373091, 7.902436186, 8.52187726, 9.109878097,
        9.476008728, 9.719620693,
      ],
      [
        2, 8, 0.15724751, 8.314178377, 0.11128469, 6.720327734, 6.904885578,
        7.197413532, 7.709516114, 8.314178377, 8.958324062, 9.573546299,
        9.958479736, 10.2153883,
      ],
      [
        2, 9, 0.070885725, 8.693418423, 0.109863709, 7.059731719, 7.247735767,
        7.546341788, 8.070932165, 8.693418423, 9.360270982, 10.00079194,
        10.40335475, 10.67280092,
      ],
      [
        2, 10, -0.00968493, 9.043261854, 0.10866078, 7.373211901, 7.564326904,
        7.868436369, 8.404399764, 9.043261854, 9.7311934, 10.3954511,
        10.81469528, 11.0960696,
      ],
      [
        2, 11, -0.085258, 9.366593571, 0.10765621, 7.662959063, 7.856916169,
        8.166068895, 8.712513432, 9.366593571, 10.07430572, 10.76106284,
        11.19624565, 11.48907597,
      ],
      [
        2, 12, -0.15640945, 9.666089185, 0.106834517, 7.93103031, 8.127621012,
        8.441459662, 8.997691667, 9.666089185, 10.39257636, 11.10088678,
        11.5514514, 11.85539095,
      ],
      [
        2, 13, -0.22355869, 9.944226063, 0.106183085, 8.179355552, 8.378425424,
        8.696684147, 9.262185089, 9.944226063, 10.68874201, 11.4179197,
        11.88347697, 12.19829279,
      ],
      [
        2, 14, -0.28701346, 10.20329397, 0.105691242, 8.409743555, 8.611186014,
        8.933679535, 9.508084539, 10.20329397, 10.96532105, 11.7149113,
        12.19522253, 12.52078451,
      ],
      [
        2, 15, -0.34699919, 10.4454058, 0.105349631, 8.62388725, 8.827637666,
        9.154251142, 9.737329319, 10.4454058, 11.2246268, 11.99437938, 12.48934,
        12.82561033,
      ],
      [
        2, 16, -0.40368918, 10.67250698, 0.105149754, 8.82336957, 9.029399482,
        9.360078736, 9.951714686, 10.67250698, 11.46877937, 12.258624,
        12.76824867, 13.11527219,
      ],
      [
        2, 17, -0.45721877, 10.88638558, 0.105083666, 9.00966812, 9.217979979,
        9.55272268, 10.15289979, 10.88638558, 11.69971783, 12.50974133,
        13.03414978, 13.39204468,
      ],
      [
        2, 18, -0.50770077, 11.08868151, 0.105143752, 9.184160166, 9.394782429,
        9.733629905, 10.34241498, 11.08868151, 11.91921144, 12.74963667,
        13.28904061, 13.65798985,
      ],
      [
        2, 19, -0.55523599, 11.28089537, 0.105322575, 9.348127323, 9.561109949,
        9.904139709, 10.52166904, 11.28089537, 12.1288704, 12.98003694,
        13.53472797, 13.91497124,
      ],
      [
        2, 20, -0.59992113, 11.46439708, 0.10561278, 9.502760074, 9.718170424,
        10.06548937, 10.69195601, 11.46439708, 12.3301562, 13.20250263,
        13.77284102, 14.1646673,
      ],
      [
        2, 21, -0.64185418, 11.64043402, 0.106007025, 9.649162144, 9.867081272,
        10.21881956, 10.85446195, 11.64043402, 12.52439148, 13.41843913,
        14.00484351, 14.40858419,
      ],
      [
        2, 22, -0.6811381, 11.81013895, 0.106497957, 9.788354721, 10.00887405,
        10.3651796, 11.01027128, 11.81013895, 12.71276942, 13.62910755,
        14.23204547, 14.64806798,
      ],
      [
        2, 23, -0.71788283, 11.97453748, 0.107078197, 9.921280547, 10.14449891,
        10.50553251, 11.16037297, 11.97453748, 12.89636272, 13.8356351,
        14.45561433, 14.88431632,
      ],
      [
        2, 24, -0.75220617, 12.13455528, 0.107740346, 10.04880788, 10.27482891,
        10.64075987, 11.30566645, 12.13455528, 13.07613212, 14.03902484,
        14.67658549, 15.11838945,
      ],
      [
        2, 25, -0.78423359, 12.2910249, 0.108477009, 10.17173431, 10.40066414,
        10.77166654, 11.44696728, 12.2910249, 13.25293459, 14.24016506,
        14.89587242, 15.35122083,
      ],
      [
        2, 26, -0.81409743, 12.44469237, 0.109280822, 10.29079052, 10.52273581,
        10.89898515, 11.58501256, 12.44469237, 13.42753102, 14.43983817,
        15.11427618, 15.5836271,
      ],
      [
        2, 27, -0.8419355, 12.59622335, 0.110144488, 10.40664383, 10.64171007,
        11.02338047, 11.72046615, 12.59622335, 13.60059358, 14.63872906,
        15.33249457, 15.8163176,
      ],
      [
        2, 28, -0.86788939, 12.74620911, 0.111060814, 10.51990171, 10.7581918,
        11.14545358, 11.8539236, 12.74620911, 13.77271274, 14.83743314,
        15.55113065, 16.0499034,
      ],
      [
        2, 29, -0.89210264, 12.89517218, 0.112022758, 10.63111516, 10.8727282,
        11.26574591, 11.98591692, 12.89517218, 13.94440383, 15.03646393,
        15.770701, 16.28490586,
      ],
      [
        2, 30, -0.91471881, 13.04357164, 0.113023466, 10.74078194, 10.98581228,
        11.38474303, 12.11691911, 13.04357164, 14.11611337, 15.23626013,
        15.99164336, 16.52176469,
      ],
      [
        2, 31, -0.93587966, 13.19180827, 0.114056316, 10.84934975, 11.09788625,
        11.50287842, 12.24734843, 13.19180827, 14.28822496, 15.43719248,
        16.21432393, 16.7608456,
      ],
      [
        2, 32, -0.95572344, 13.34022934, 0.115114952, 10.95721927, 11.2093447,
        11.62053697, 12.37757256, 13.34022934, 14.46106492, 15.63957012,
        16.43904429, 17.00244749,
      ],
      [
        2, 33, -0.97438101, 13.48913357, 0.116193337, 11.06474677, 11.32053756,
        11.73805834, 12.50791269, 13.48913357, 14.634908, 15.84364677,
        16.66604772, 17.24680884,
      ],
      [
        2, 34, -0.99198075, 13.63877446, 0.11728575, 11.17224778, 11.43177357,
        11.85574032, 12.63864672, 13.63877446, 14.80998135, 16.04962601,
        16.89552564, 17.49411514,
      ],
      [
        2, 35, -1.00864074, 13.78936547, 0.118386847, 11.27999893, 11.54332263,
        11.9738418, 12.77001339, 13.78936547, 14.98647034, 16.25766706,
        17.12762297, 17.74450372,
      ],
      [
        2, 36, -1.01665314, 13.86507382, 0.118939087, 11.33404488, 11.59928903,
        12.03312087, 12.83599859, 13.86507382, 15.07529315, 16.36249956,
        17.24468787, 17.87088515,
      ],
    ];

    if (sexo === "hombre") {
      matriz3 = vPesosHombre;
    } else {
      matriz3 = vPesosMujer;
    }

    var arrayValores3 = matriz3[mes];

    var aux_zscore3 = parseInt(percentilPeso) / arrayValores3[3];

    var zScore3 = Math.log(aux_zscore3) / arrayValores3[4];
    var BASE3 = 1 + arrayValores3[2] * arrayValores3[4] * zScore3;
    var EXPONENTE3 = 1 / arrayValores3[2];
    var percentileScore3 = arrayValores3[3] * BASE3 ** EXPONENTE3;

    if (
      percentileScore2 >= arrayValores3[5] &&
      percentileScore2 < arrayValores3[6]
    ) {
      resultadoPeso = 3;
    }
    if (
      percentileScore3 >= arrayValores3[6] &&
      percentileScore3 < arrayValores3[7]
    ) {
      resultadoPeso = 5;
    }
    if (
      percentileScore3 >= arrayValores3[7] &&
      percentileScore3 < arrayValores3[8]
    ) {
      resultadoPeso = 10;
    }
    if (
      percentileScore3 >= arrayValores3[8] &&
      percentileScore3 < arrayValores3[9]
    ) {
      resultadoPeso = 25;
    }
    if (
      percentileScore3 >= arrayValores3[9] &&
      percentileScore3 < arrayValores3[10]
    ) {
      resultadoPeso = 50;
    }
    if (
      percentileScore3 >= arrayValores3[10] &&
      percentileScore3 < arrayValores3[11]
    ) {
      resultadoPeso = 75;
    }
    if (
      percentileScore3 >= arrayValores3[11] &&
      percentileScore3 < arrayValores3[12]
    ) {
      resultadoPeso = 90;
    }
    if (
      percentileScore3 >= arrayValores3[12] &&
      percentileScore3 < arrayValores3[13]
    ) {
      resultadoPeso = 95;
    }
    if (
      percentileScore3 >= arrayValores3[13] &&
      percentileScore3 < arrayValores3[14]
    ) {
      resultadoPeso = 97;
    }
    if (
      percentileScore3 < arrayValores3[13] &&
      percentileScore3 > arrayValores3[14]
    ) {
      resultadoPeso = 0;
    }

    /***************************************************/

    const ninio = await Ninio.findById(paciente);

    try {
      const percent = new Percent({
        paciente,
        percentilCabeza: resultadoCabeza,
        percentilAltura: resultadoLargo,
        percentilPeso: resultadoPeso,
        sexo,
        mes,
      });

      const percentSaved = await percent.save();

      ninio.percentiles = ninio.percentiles.concat(percentSaved._id);
      await ninio.save();

      res.json({ percent: percentSaved });
    } catch (error) {
      res.status(400).json({ error: error.message });
    }
  } catch (error) {
    console.log(error);
    res.status(500).send("Hubo un error");
  }
};

exports.getPercent = async (req, res) => {
  try {
    const { paciente } = req.body;

    const percent = await Percent.find({ paciente });

    res.json({ percent });
  } catch (error) {
    console.log(error);
    res.status(500).send("Hubo un error");
  }
};
